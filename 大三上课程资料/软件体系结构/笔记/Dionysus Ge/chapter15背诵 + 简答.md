# 第15章（Architectures in Agile Projects）

------

## 一、必背定义（22个，全部“可抄型”）

> 统一格式：**术语(英文)** — 一句话定义 — **关键点2条** — **常见误区1条**

1. **Agile（敏捷过程）** — 为更快响应干系人、频繁交付有价值软件而形成的一组开发原则/实践。

- 关键点：①强调早交付、持续交付；②强调减少“必然会变”的文档负担。
- 误区：把敏捷等同于“不要架构/不要设计”。

1. **Agile vs Architecture Question（敏捷与架构的正确问题）** — 不是“要敏捷还是要架构”，而是“**前期做多少架构**、**何时文档化多少架构**”。

- 关键点：①关注“up-front vs defer”；②关注“document how much & when”。
- 误区：二选一思维。

1. **Up-front Architecture Work（前期架构工作）** — 项目早期对架构的设计工作（含关键决策/结构）。

- 关键点：①会增加早期投入；②目标是降低后期全局返工风险。
- 误区：把它当成“瀑布式一次性大设计”。

1. **Up-front Risk Identification/Planning/Resolution（前期风险识别/规划/化解）** — 在早期主动找出并处理架构与项目风险的活动。

- 关键点：①属于“会加时间”的活动之一；②与返工存在 tradeoff。
- 误区：认为风险只能等问题出现再修。

1. **Rework（返工）** — 因修缺陷、应对修改请求而产生的重复开发成本/时间。

- 关键点：①来源：defects + modification requests；②前期架构/风险处理越少，后期返工往往越大。
- 误区：把返工仅理解为“代码写错”。

1. **Tradeoff（权衡）** — 在多个质量目标/成本目标之间做取舍的架构决策过程。

- 关键点：①权衡要“可论证”；②常通过场景/实验来验证。
- 误区：把权衡写成“拍脑袋选择”。

1. **Sweet Spot（最优折中点）** — 使“总加时（前期投入+返工）”最低的前期架构投入点。

- 关键点：①不同规模项目 sweet spot 不同；②不是越多越好/越少越好。
- 误区：认为 sweet spot 是固定比例。

1. **KSLOC（Kilo Source Lines of Code）** — 千行代码规模度量单位，用于粗略表达项目大小。

- 关键点：①10/100/1000 KSLOC 用于示例比较；②规模越大，前期架构投入“合理比例”越高。
- 误区：把 KSLOC 当精确生产率指标。

1. **Sweet Spot Data Point（甜蜜点数据）** — 100KSLOC≈20%，1000KSLOC≈40%；10KSLOC几乎在最左（不值得大量前期投入）。

- 关键点：①规模越大越需要架构指导；②大到百万行级仅靠敏捷原则难以应付复杂度。
- 误区：只背数字不写因果（复杂度/集成风险）。

1. **Write for the Reader（为读者写文档）** — 文档只写对读者有用的内容；读者可能是维护者/新人。

- 关键点：①读者不需要就不写；②但要考虑“未来读者”。
- 误区：把它理解成“文档越少越好”。

1. **Architecture Evaluation in Agile（敏捷中的架构评估）** — 架构评估可以作为敏捷过程的一部分，用于回应干系人关键关注点。

- 关键点：①“Absolutely”可行；②符合敏捷“满足重要关注点”的理念。
- 误区：认为评估必然很重、只能放在项目末期。

1. **ATAM（Architecture Tradeoff Analysis Method）** — 以质量属性场景驱动，揭示架构决策、风险与权衡点的评估方法。

- 关键点：①不试图分析全部架构；②评估焦点由“最重要场景”决定。
- 误区：把 ATAM 写成“性能测试”。

1. **Quality Attribute Scenario（质量属性场景）** — 表达干系人最重要质量关注点的场景集合，用来决定评估焦点。

- 关键点：①代表最重要关注点；②驱动评估/分析范围。
- 误区：把“场景”写成纯功能用例。

1. **Lightweight Architecture Evaluation（轻量评估）** — 基于场景聚焦，可裁剪成更轻量的架构评估方式。

- 关键点：①“easy to tailor”；②只评估关键风险/权衡。
- 误区：认为轻量=不严谨。

1. **Agile Architecting Example（敏捷架构化实例）** — WebArrow 案例展示敏捷下仍需架构分析与约束验证并行。

- 关键点：①同时两种工作模式；②用实验支撑权衡。
- 误区：把案例当“写一个原型就结束”。

1. **Top-down Mode（自顶向下模式）** — 设计/分析架构结构以满足苛刻质量属性需求与权衡。

- 关键点：①面向质量属性；②面向结构与决策。
- 误区：只做“画图”，不做权衡说明。

1. **Bottom-up Mode（自底向上模式）** — 分析实现细节与环境约束并形成可落地方案。

- 关键点：①实现/环境约束驱动；②反向校正 top-down 架构设想。
- 误区：只顾实现细节，不顾全局质量目标。

1. **Spike（尖峰实验）** — 为分析架构权衡而做的探索性实验（agile 术语）。

- 关键点：①rigorous experiments；②回答关键 tradeoff 问题。
- 误区：把 spike 写成“做个 demo 给领导看”。

1. **Experimentation Emphasis（强调实验）** — 让架构过程敏捷化不需“方法重造”，关键是强调实验验证。

- 关键点：①不 radical reinvent；②实验是关键成功因素。
- 误区：认为敏捷=凭感觉快速改。

1. **ICM（Incremental Commitment Model，增量承诺模型）** — 用“增量承诺 + 风险锚点”融合敏捷与架构治理。

- 关键点：①承诺/系统定义演化式增长；②风险驱动锚点里程碑同步稳定并发活动。
- 误区：把 ICM 写成“只是更频繁迭代”。

1. **Success-critical Stakeholders（成功关键干系人）** — 对系统成功最关键、必须参与承诺与问责的干系人。

- 关键点：①commitment & accountability；②不参与会导致目标不一致。
- 误区：把干系人等同“任何用户”。

1. **Satisficing（满意化/阈值满足）** — 通过谈判与权衡达到可接受阈值（acceptability threshold），而非追求绝对最优。

- 关键点：①success-based negotiations；②tradeoffs 驱动。
- 误区：把 satisficing 写成“凑合、低标准”。

（额外你也要会用：**candidate architecture、major patterns、distributed development、technical debt、refactor、middle ground** 都在同一章建议/总结页出现。）

------

## 二、10个对比题标准答案（可直接背）

1. **Agile vs Architecture（敏捷 vs 架构）**

- 敏捷：价值在“快速响应、频繁交付、减少无谓文档”。
- 架构：价值在“结构/约束/权衡”，控制质量风险与复杂度。
- 结论：不是二选一；核心是“**up-front 做多少 & 何时文档化多少**”。

1. **Up-front Work vs Rework（前期投入 vs 后期返工）**

- Up-front：架构设计 + 风险识别/化解，会加早期时间。
- Rework：缺陷修复 + 变更请求导致返工，会加后期时间。
- 结论：二者 tradeoff，存在 sweet spot。

1. **Sweet Spot vs “越少越敏捷”（甜蜜点 vs 少设计信条）**

- Sweet spot：总成本最小的折中点。
- “越少越敏捷”：忽略规模/风险，容易导致返工爆炸。
- 结论：敏捷不是少设计，而是**合适的前期架构投入**。

1. **Write for the reader vs Comprehensive documentation（为读者写 vs 全面文档）**

- 为读者写：读者不需要就不写，但考虑维护者/新人。
- 全面文档：追求“写全写满”，在高变更环境很快失效。
- 结论：敏捷文档=最小且有受众的文档集合。

1. **ATAM vs Performance Testing（ATAM vs 性能测试）**

- ATAM：场景驱动，分析决策、风险、权衡点（质量属性层）。
- 性能测试：测量实现的性能指标（实现层）。
- 结论：ATAM回答“架构是否支持关键质量属性与权衡”，不是跑压测。

1. **Full Evaluation vs Lightweight Evaluation（完整评估 vs 轻量评估）**

- 完整：覆盖面更大、组织成本更高。
- 轻量：聚焦最重要质量属性场景，易裁剪执行。
- 结论：敏捷里常用轻量化以匹配迭代节奏。

1. **Top-down vs Bottom-up（自顶向下 vs 自底向上）**

- Top-down：为质量属性与权衡设计结构。
- Bottom-up：为实现/环境约束找方案并反向校正。
- 结论：敏捷架构要“两条腿走路”，并行推进。

1. **Spike vs Prototype（Spike vs 原型）**

- Spike：为回答权衡/风险问题做实验（证据驱动）。
- Prototype：常面向展示/验证可用性或概念可行（不一定量化权衡）。
- 结论：考场写 spike 必须写“**用于 tradeoff 分析的实验**”。

1. **Candidate Architecture vs Detailed Architecture（候选架构 vs 细化架构）**

- 候选架构：先快速定大方向（可缺细节），适合需求不稳定的大项目。
- 细化架构：在需求/约束逐步清晰后，结合 spikes 持续 elaboration。
- 结论：需求不稳时先候选、后演化。

1. **Technical Debt vs Refactor（技术债 vs 重构）**

- 技术债：为了短期交付形成的长期维护/演进成本累积。
- 重构：当债务过大时，必须通过结构性调整来还债。
- 结论：敏捷架构师走中道：先跑起来，但到拐点必须 refactor。

------

## 三、6道简答题标准答案（“完全应试段落”）

### 1）为什么“敏捷与架构不冲突”？应如何提问？

**标准答案要点：**

- 敏捷的目标是更快响应干系人、频繁交付，并减少会改变的无谓文档；这些需求与架构并不冲突。
- 正确问题不是“选敏捷还是选架构”，而是：①前期架构做多少、多少推迟到需求更清晰后；②架构文档化多少、何时文档化。

### 2）解释 up-front 工作与 rework 的关系，并说明 sweet spot 的含义（可给数据）

**标准答案要点：**

- 项目进度加时来自两类活动：①前期架构设计与前期风险识别/化解；②缺陷修复与变更请求引起的返工（rework）。二者直觉上 tradeoff。
- sweet spot 是使“总加时（前期投入+返工）”最低的前期投入点。规模越大 sweet spot 越靠右：100KSLOC 约 20%，1000KSLOC 约 40%，10KSLOC 在最左（大量前期投入浪费）。

### 3）敏捷项目中架构文档应如何写？（写作原则）

**标准答案要点：**

- 原则：**Write for the reader**。读者不需要就不写，但必须考虑未来维护者/新人等潜在读者。
- 效果：避免“为完整而完整”的文档，把文档投入集中在能降低沟通/交接/维护成本的关键内容上。

### 4）为什么 ATAM 能融入敏捷？如何轻量化？

**标准答案要点：**

- ATAM 评估可作为敏捷的一部分，因为敏捷哲学核心是满足干系人最重要关注点。
- ATAM 不试图分析全部架构；其焦点由一组**质量属性场景**决定，代表干系人最重要关注点，因此很容易裁剪成轻量评估。

### 5）什么是 spike？它解决什么架构问题？请举例

**标准答案要点：**

- spike 是敏捷术语，指为分析架构权衡而进行的探索性实验；通过严格实验用证据回答关键 tradeoff 问题。
- 示例（举2–3个即可）：迁移到分布式数据库是否恶化用户延迟；mod_perl 相对标准 Perl 的可扩展提升；单台 meeting server 容量上限；数据库服务器与 meeting server 的合理配比等。

### 6）概述 ICM 的核心思想，并给出“何时多做 upfront 架构”的建议

**标准答案要点：**

- ICM（增量承诺模型）用来融合敏捷与架构：强调成功关键干系人的承诺与问责、satisficing（可接受阈值）下的谈判权衡、系统定义与承诺的增量演化、迭代开发，以及风险驱动的锚点里程碑来同步与稳定并发活动。
- 建议：大型复杂且需求稳定/理解充分、或分布式开发时，较多 upfront 架构会带来回报；大型但需求不稳定时先快速做 candidate architecture，再结合 spikes 演化细化；小项目需求不确定时至少先统一 major patterns，但不宜重投入文档与分析。

