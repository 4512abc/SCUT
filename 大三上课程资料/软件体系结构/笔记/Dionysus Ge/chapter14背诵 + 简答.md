# Chapter14 Quality Attribute Modeling and Analysis

“质量属性分析是成本/收益活动：对性能、可用性等可用解析模型定量估算；当模型不成熟或参数不确定时，用清单补齐需求、用思想实验走查机制与冲突、用粗算做数量级判断；在设计阶段用仿真与原型降低关键决策不确定性，在实现/上线阶段用实验、合成负载与监控获得实证并定位瓶颈，分析方法随生命周期阶段切换。”

------

## A) 必背定义（20个，>15）

> 格式：**术语(英文)** — 一句话定义 — 关键点2条 — 常见误区1条

1. **Analytic model（解析模型）** — 支持**定量（quantitative）**分析的模型。— *关键点*：①可计算输出（如延迟/可用性）②依赖可估参数。— *误区*：把“画图/类图”当解析模型。
2. **Performance model（性能模型）** — 用到达/服务/调度/网络等参数估算性能指标（典型：延迟）。— *关键点*：①参数驱动②常用排队模型。— *误区*：只谈“快不快”，不写参数。
3. **Arrival rate（到达率）** — 外部事件/请求进入系统的频率参数。— *关键点*：①决定负载强度②常用于排队模型输入。— *误区*：把“并发数=到达率”。
4. **Service time（服务时间）** — 处理一个事件/请求所需时间参数。— *关键点*：①与吞吐/延迟相关②通常需估计或测量。— *误区*：把“响应时间=服务时间”（响应时间还包含排队/网络）。
5. **Queuing discipline（排队纪律）** — 队列如何选择下一个被服务对象的规则。— *关键点*：①影响等待时间②与系统策略相关。— *误区*：忽略排队纪律，导致模型不完整。
6. **Scheduling algorithm（调度算法）** — 资源（CPU/线程等）如何分配给任务的规则。— *关键点*：①影响延迟分布②是性能模型关键参数之一。— *误区*：把调度当“实现细节不影响架构”。
7. **Network topology（网络拓扑）** — 系统节点/连接方式的结构参数。— *关键点*：①影响路径与拥塞②与带宽/路由共同决定网络延迟。— *误区*：只写“有网络”，不写拓扑/带宽。
8. **Network bandwidth（网络带宽）** — 链路可用传输能力参数。— *关键点*：①影响传输时间②是MVC性能模型参数之一。— *误区*：把带宽当固定不变、无需估计。
9. **Routing algorithm（路由算法）** — 消息/请求选择路径的策略参数。— *关键点*：①影响拥塞与延迟②属于性能模型可选参数。— *误区*：忽略路由策略导致预测失真。
10. **Cost/benefit of performance modeling（性能建模的成本收益）** — 成本=确定参数；收益=估计延迟；当“延迟重要且存疑”才值得。— *关键点*：①参数越准预测越准②明显容量足够则不值得。— *误区*：以为“必须建模”。
11. **Availability modeling（可用性建模）** — 基于架构推可用性，本质是确定组件**failure rates**与**recovery times**。— *关键点*：①同样需要“可分析的架构”②参数是故障与恢复。— *误区*：只写“加冗余就好”，不写故障/恢复参数。
12. **Failure rate（故障率）** — 组件发生故障的发生率/概率特征量。— *关键点*：①决定不可用风险②用于系统级合成计算。— *误区*：把故障率和修复时间混为一谈。
13. **Recovery time（恢复时间）** — 故障后恢复到可服务状态所需时间。— *关键点*：①直接影响可用性②与策略/运维有关。— *误区*：忽略恢复时间只算“是否故障”。
14. **Active redundancy / Hot spare（主动冗余/热备）** — 用并行冗余提高可用性的一类策略（hot spare）。— *关键点*：①属于提高Broker可用性的战术②是冗余战术之一。— *误区*：把hot/warm/cold当“启动快慢口号”，不落到冗余策略。
15. **Passive redundancy / Warm spare（被动冗余/温备）** — 备份策略之一（warm spare）。— *关键点*：①可用概率模型比较收益②常与独立故障假设配合。— *误区*：不知道“系统失效常是主备同时失效（AND）”。
16. **Spare / Cold spare（冷备）** — 备机平时不承担服务的一类冗余策略（cold spare）。— *关键点*：①属于Broker可用性提升战术②常在成本/恢复时间上权衡。— *误区*：把cold spare当“没有冗余”。
17. **Independent events（独立事件）** — A与B互不影响；用于概率相加/相乘规则。— *关键点*：①P(A or B)=P(A)+P(B)（PPT给的独立情形）②P(A and B)=P(A)·P(B)。— *误区*：把AND/OR乱用。
18. **Dependent events & Conditional probability（相关事件与条件概率）** — 相关事件用 P(A and B)=P(A)·P(B|A)。— *关键点*：①相关性必须体现到模型②P(B|A)是“在A发生条件下B发生概率”。— *误区*：所有情况都当独立。
19. **Quality attribute checklist（质量属性清单）** — 用于（1）检查需求是否覆盖细节（2）审计设计是否满足认证流程的条目集合。— *关键点*：①Checking requirements②Auditing/certification。— *误区*：把清单当“测试用例”。
20. **Thought experiment（思想实验）** — 对特定场景进行口头/脑内推演：设计期探索替代方案，评估期说服第三方设计合理。— *关键点*：①scenario驱动②产物是问题清单/后续分析触发。— *误区*：当“随便想想”不按步骤走查。

> 你还需要一起背的“方法论总句”：**Analysis is always a cost/benefit activity**；成本=创建与执行模型/工具，收益取决于准确性与分析对象的重要性。

------

## B) 10个对比题标准答案（含你点名的4组）

> 统一写法：先一句话区分，再给2–3个判分点。

### 1) **Structure vs View（结构 vs 视图）**

- **答：Structure是元素及其关系本身；View是对某一组结构的表示/文档化呈现。架构师设计structures，文档化views。**

### 2) **Module vs Component（模块 vs 构件/组件）**

- **答：Module偏静态实现单元（代码/责任分配）；Component偏运行时执行单元。二者映射通常是多对多，不要期待一一对应。**

### 3) **Layer vs Tier（层 vs 层级部署）**

- **答：Layer是模块类型的逻辑分层（按功能责任/依赖约束组织）；Tier是部署/执行结构中的逻辑分组（组件分组并可映射到平台）。**

### 4) **Pattern vs Tactic（模式 vs 战术）**

- **答：Pattern是反复出现的“设计决策包/架构类”；Tactic是影响某个质量属性响应的单个设计决策。模式可视为由战术组成并需用战术补足到具体系统。**

### 5) **Analytic model vs Measurement（解析模型 vs 测量）**

- **答：解析模型在早期用参数推导定量结果；测量依赖可运行实现/系统，通过监控/实验得到真实行为数据。**

### 6) **Checklist vs Thought experiment（清单 vs 思想实验）**

- **答：清单是“覆盖性检查”（需求细节/认证审计）；思想实验是“场景推演”（每步机制支持哪个QA、是否伤害其他QA，并记录问题）。

### 7) **Back-of-the-envelope vs Deep analysis（纸上估算 vs 深度分析）**

- **答：纸上估算不求精细，用数量级快速判断；深度分析只对“重要且存疑”的区域投入。**

### 8) **Simulation vs Prototype（仿真 vs 原型）**

- **答：仿真=构建可控的模拟世界来跑不同负载与响应；原型=用部分实现去验证最重要决策，并尽量可复用到最终系统。**

### 9) **Product requirements vs Process requirements（产品要求 vs 过程要求）**

- **答：产品要求约束系统“做成什么/不做什么”（如敏感信息不应存储）；过程要求约束组织“怎么做/谁负责”（如补丁及时应用并明确责任）。**

### 10) **Independent vs Dependent events（独立 vs 相关事件）**

- **答：独立事件用P(A and B)=P(A)·P(B)；相关事件必须用条件概率P(B|A)。区分点在“一个事件是否改变另一个事件发生概率”。**

------

## C) 6道简答题标准答案（完全应试）

### 1) 什么是解析模型（analytic model）？为什么在架构阶段有用？

**答：**解析模型是支持定量分析的模型。它在架构阶段通过可估参数对性能/可用性等质量属性进行量化预测，从而在实现前识别风险与瓶颈并支持权衡决策。

### 2) 做性能建模需要哪些关键参数？什么时候“值得建模”？

**答：**性能模型典型参数包括到达率、排队纪律、调度算法、服务时间、网络拓扑/带宽、路由算法等。建模成本在于参数确定；收益是延迟估计。仅当延迟重要且容量是否足够“存在疑问”时值得建模；若明显容量充足则不值得投入。

### 3) 如何基于架构建模系统可用性（以Broker+冗余为例）？

**答：**可用性建模的核心是确定组件的故障率/故障概率与恢复时间，并基于架构识别单点故障（如Broker）。可通过冗余战术（active redundancy/hot spare、passive redundancy/warm spare、cold spare）把单点故障转为保护组，并结合独立/相关事件的概率运算推导系统失效概率，从而比较战术收益并做成本收益权衡。

### 4) 质量属性清单（checklist）有什么用？安全清单为什么特殊？

**答：**质量属性清单用于：（1）检查需求是否覆盖该质量属性的关键细节；（2）审计设计是否满足认证流程要求。安全清单常见于合规场景（如PCI），并同时包含产品要求（如敏感信息不应存储）与过程要求（如补丁及时应用并明确责任），覆盖技术与组织两方面风险。

### 5) 思想实验（thought experiment）怎么做？产出是什么？

**答：**步骤：枚举关键用例的执行步骤；在每一步识别所采用机制支持哪个具体质量需求；再检查该机制是否妨碍其他质量属性；把发现的问题记录下来，用于后续更深入分析或原型验证。产出是问题/风险清单与后续行动触发点，而非“证明正确”。

### 6) 生命周期不同阶段应采用哪些质量属性分析方法？

**答：**分析是成本/收益活动，应随阶段选择方法：需求阶段用解析模型/纸上估算辅助容量规划，并用清单确保捕获正确需求；设计阶段用原型探索关键决策、用解析模型或仿真理解潜在瓶颈、用清单核对机制；实现/上线阶段用实验与合成负载测试验证行为，并用监控获得真实运行数据定位瓶颈。

------

