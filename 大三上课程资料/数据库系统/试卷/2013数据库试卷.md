# 2013数据库试卷

## 一、填空题
1. A ==Data Model== is a collection of conceptual tools for describing data, data relationships, data semantics and consistency constraints.

2. The participation of an entry set E in a relationship set R is said to be ==total participation== if every entity in E participate in at least one relationship in R. if only some entities in E participate in relationship set R, the participation is said to be partial.

3. A ==view== is a virtual relation that is not part of the logical model, but is mode visible to a user.

4. Integrity constrains guard against accidental damage to the database the allowed integrity constrains in relational database include ==primary key, not null, unique and default, foreign key, check predicate.==

5. An index entry consists of ==a search-key and pointer== to one more records in the data file.

6. Consider a B+ tree of order n. if there are k search-key values in the file, the path from the root to the leaf node is no longer than ==$log_{\lceil \frac{n}{2}\rceil}(K)$==。

7. The two most important heuristic rule is: 

   - (a) perform selection & projection operations as early as possible; 
   - (b) ==perform most restrictive selection and join operation early.==

8. Data items can be locked for a transaction in two modes: 

   ==exclusive mode and shared mode in lock-based concurrency control scheme.==

9. The ==immediate database modification== scheme allows database modifications to be output to the database while the transaction is still in the ==uncommitted== state.

## 二、建表语句
### （1）申请表（apply_form）
```sql
create table apply_form (
apply_id char(11) not null,
subject varchar(11) not null,
add constraint A_id primary key (apply_id)
);
```

### （2）维修人员表（repairer）
```sql
Create table repairer (
Repairer_id char(11) not null,
Name varchar(11) not null,
R_id char(11) not null,
Add constraint P_id primary key (Repairer_id),
Add constraint FK_A foreign key (R_id)
references repair_record(Record_id)
);
```

### （3）维修记录表（repair_record）
```sql
Create table repair_record (
Record_id char(11) not null,
Fee float (5, 2) not null,
Repair_date date not null,
Add constraint R_id primary key (Record_id)
);
```

### （4）维修关联表（repair）
```sql
Create table repair(
Record_id char(11) not null,
Repairer_id char(11) not null,
Add constraint FK_R foreign key (Record_id)
references repair_record(Record_id),
add constraint FK_P foreign key (Repairer_id)
references repairer(Repairer_id)
);
```

## 三、SQL查询/操作语句
### （1）查询重量最小的零件编号
```sql
Select PNO
From PART
Where PART.weight = MIN (weight);
```

### （2）查询为工程J1提供所有零件的供应商名称和所在城市
```sql
select SName, Scity
From SPJ as S1, supplier
Where S1.SNO = supplier.SNO
And not exists (
select JNO from SPJ where JNO = "J1"
except
select JNO from SPJ as S2
where S1.SNO = S2.SNO
);
```

### （3）按工程编号升序分组，查询每个工程订购的零件数量
```sql
select JNO, count (PNO) AMOUNT
From SPJ
Order by JNO ASC
Group by JNO;
```

### （4）删除供应商“LTM”及其相关的订单记录
```sql
delete from SPJ
Where SPJ.SNO = (
select SNO from Supplier where Sname = "LTM");

delete from supplier
Where supplier.SName = "LTM";
```

### （5）向项目表（Project）插入一条新记录
```sql
Insert into Project (Jname, Jcity)
Values ('Sys', 'shanghai');
```

### （6）查询为工程J1提供红色零件的供应商编号
```sql
Select SNO
From part, SPJ
Where part.Pcolor = 'red'
And part.PNO = SPJ.PNO
And SPJ.JNO = 'J1';
```

### （7）查询未使用天津供应商提供的红色零件的工程编号
```sql
select JNO
From SPJ
Except
Select JNO
From SPJ, Supplier, Part
Where Supplier.SCity = 'tianjing'
And SPJ.SNO = Supplier.SNO
And Part.Pcolor = 'red'
And Part.PNO = SPJ.PNO;
```

### （8）查询索尼（sony）供应商提供的红色零件对应的工程编号
```sql
select JNO
from supplier as S, SPJ, part as P
where S.name = 'sony'
and p.color = 'red'
and s.sno = spj.sno
and spj.pno = p.pno;
```

### （9）补充语句（原文片段）
```sql
select JNO from part where JNO = "J1";
```