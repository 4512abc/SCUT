# 2015 数据库试卷 A 卷

# 数据库系统试卷（A）题目
## Part I 填空题（共20分，每小题1分）
1. The collection of information stored in the database at a particular moment is called an **实例**of the database. The overall design of the database is called the database **模式**.
2. A relation schema $ R $ is in **第三** normal form if for all $ \alpha \to \beta $ in $ F^+ $, at least one of the following holds: $ \alpha \to \beta $ is **平凡函数依赖($\beta$ 包含于 $\alpha$);** $ \alpha $ is a super key for $ R $; Each attribute $ A $ in $ \beta - \alpha $ is contained in a candidate key for $ R $.
3. Let $ R $ be a relation schema, $ R_1 $ and $ R_2 $ form a decomposition of $ R $. Decomposition is a **无损分解**  if for all legal database instances $ r $ of $ R $, $ \Pi_{R_1}(r) \bowtie \Pi_{R_2}(r) = r $.
4. In E-R model, an entity is represented by a set of **属性**. A **关系** is an association among several entities.
5. Assume relation $ r $ has $ b_r $ blocks and relation $ s $ has $ b_s $ blocks, therefore, in the best case, only ==br+bs== block transfers would be required for $ r \bowtie s $.
6. An ideal hash function is **均匀** and **随机**, the former requires that each bucket is assigned the same number of search-key values from the set of all possible values.
7. To generate query-evaluation plans for an expression we have to generate logically equivalent expressions using ==等价规则==.
10. When the final statement of a transaction has been executed, the transaction enters the ==partically committed== state. After a transaction has been rolled back and the database has been restored to its previous state, the transaction enters the ==aborted== state.
11. A schedule $ S $ is ==可恢复的== if a transaction $ T_j $ in $ S $ reads a data item previously written by a transaction $ T_i $, then the commit operation of $ T_i $ appears before the commit operation of $ T_j $.
12. 复合 attribute values or 多值 attribute values are not atomic.

## Part Ⅱ 简答题与计算题（共80分）
### 一、数据库设计Ⅰ（16分）
已知条件：
- 学生（STUDENT）只能由一位教师（TEACHER）授课，一位教师可指导多名学生。
- 教师只能负责一个班级（CLASS），一个班级只能由一位教师负责。
- 班级由多名学生组成，学生必须属于一个班级。
- 班级必须有一个教室（ROOM），一个教室可属于多个班级。

备注：
- 实体CLASS的属性：CID、CNAME
- 实体ROOM的属性：RID、LOCATION
- 实体STUDENT的属性：SID、LASTNAME、FIRSTNAME
- 实体TEACHER的属性：TID、TEACHERNAME、TITLE

1. （8分）构建E-R图表示上述关系。
2. （4分）为上述E-R图构建合适的关系模式。
3. （4分）在学生关系上创建以SID为搜索键的索引std_index。

### 二、数据库设计相关问题（6分）
在数据库设计中，如何将关系集（relationship set）表示为关系模式？

### 三、关系模式规范化（14分）
设关系模式 $ R=(A,B,C,D,E,F) $，函数依赖集 $ F=\{A \to CB, E \to FA\} $
1. （2分）计算 $ R $ 的候选码；
2. （6分）$ R $ 是否属于3NF？若是，说明理由；若否，将其分解为3NF模式集；
3. （6分）$ R $ 是否属于BCNF？若是，说明理由；若否，将其分解为BCNF模式集。

### 四、SQL操作与关系代数（28分）
已知关系模式：
- BOOK (Bookid, Title, Publishername)
- BOOK_AUTHORS (Bookid, Authorname)
- PUBLISHER (Publishername, Address, Phone)
- BOOK_COPIES (Bookid, Branchid, No_Of_Copies)
- LIBRARY_BRANCH (Branchid, Branchname, Address)
- BOOK_LOANS (Bookid, Branchid, Cardno, DataOut, Duedata)
- BORROWER (Cardno, Name, Address, Phone)

#### （一）SQL查询（16分）
1. 查询标题为《The Lost Tribe》的图书在名为“Sharpstown”的图书馆分馆有多少册副本？
2. 对于每个图书馆分馆，检索分馆名称及其借出的图书总数。
3. 检索所有借出图书超过5本的借阅者的姓名、地址和借出图书数量。
4. 对于每本由“Stephen King”创作（或合著）的图书，检索其标题以及在名为“Central”的图书馆分馆的副本数量。

#### （二）数据删除（3分）
记录管理员未维护名为“T&G”的图书信息这一事实，即删除该图书的相关信息。

#### （三）SQL DDL语句（3分）
编写声明BOOK_AUTHORS关系的SQL DDL语句。

#### （四）关系代数查询（6分）
1. 检索没有借出任何图书的借阅者姓名。
2. 对于从“Sharpstown”分馆借出且到期日为今天的每本图书，检索图书标题、借阅者姓名和借阅者地址。

### 五、查询处理、优化与事务（16分）
1. （4分）请描述选择操作 $ \sigma_{A=c}(r) $ 的实现过程（其中 $ r $ 是关系，$ A $ 是属性且非候选码，$ r $ 上有基于 $ A $ 的主索引）。若有 $ n $ 条匹配记录，B+树索引的高度为 $ h $，每个磁盘块最多包含 $ a $ 条记录，请分析最佳情况下的开销。
2. （4分）描述索引嵌套循环连接（Indexed nested-loop join）的过程。
3. （4分）请描述两段锁协议（two-phase locking protocol），并证明它能保证冲突可串行化调度，但不能保证无死锁。
4. （4分）（题目未完整呈现，按原文保留）